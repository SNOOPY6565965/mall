{"ast":null,"code":"import CountBox from '@/components/CountBox.vue';\nimport { mapState, mapGetters } from 'vuex';\nexport default {\n  name: 'ShoppingPage',\n  data() {\n    return {\n      isEdit: false\n    };\n  },\n  created() {\n    // 必须是登录过的用户，才能打开购物车列表\n    if (this.$store.getters.token) {\n      this.$store.dispatch('cart/getCartAction');\n    }\n  },\n  methods: {\n    toggleCheck(goodsId) {\n      this.$store.commit('cart/toggleCheck', goodsId);\n    },\n    toggleAllCheck() {\n      this.$store.commit('cart/toggleAllCheck', !this.isAllChecked);\n    },\n    changeCount(goodsNum, goodsId, goodsSkuId) {\n      // console.log(goodsNum, goodsId, goodsSkuId)\n      // 调用 vuex 的 action，进行数量的修改\n      this.$store.dispatch('cart/changeCountAction', {\n        goodsNum,\n        goodsId,\n        goodsSkuId\n      });\n    },\n    handleDel() {\n      if (this.selCount === 0) return;\n      this.$store.dispatch('cart/delSelect');\n    }\n  },\n  computed: {\n    ...mapState('cart', ['cartList']),\n    ...mapGetters('cart', ['cartTotal', 'selCartList', 'selCount', 'selPrice', 'isAllChecked'])\n  },\n  components: {\n    CountBox\n  },\n  watch: {\n    isEdit(value) {\n      if (value) {\n        this.$store.commit('cart/toggleAllCheck', false);\n      } else {\n        this.$store.commit('cart/toggleAllCheck', true);\n      }\n    }\n  }\n};","map":{"version":3,"names":["CountBox","mapState","mapGetters","name","data","isEdit","created","$store","getters","token","dispatch","methods","toggleCheck","goodsId","commit","toggleAllCheck","isAllChecked","changeCount","goodsNum","goodsSkuId","handleDel","selCount","computed","components","watch","value"],"sources":["src/views/home/shopping.vue"],"sourcesContent":["<!-- 购物车 -->\r\n<template>\r\n  <div class=\"shopping\">\r\n    <van-nav-bar title=\"购物车\" />\r\n    <div class=\"edit-box\">\r\n      <span>共{{cartTotal}}件商品</span>\r\n      <van-icon name=\"edit\" @click=\"isEdit = !isEdit\">编辑</van-icon>\r\n    </div>\r\n    <div class=\"checked-box\" v-for=\"item in cartList\" :key=\"item.goods_id\">\r\n      <van-checkbox :value=\"item.isChecked\" @click=\"toggleCheck(item.goods_id)\"></van-checkbox>\r\n      <img :src=\"item.goods.goods_image\">\r\n        <div class=\"goods\">\r\n          <p class=\"p1\">{{ item.goods.goods_name }}</p>\r\n          <p class=\"p2\">￥{{ item.goods.goods_price_min }}</p>\r\n          <!-- 即希望保留原本的形参，又需要通过调用函数形参 => 箭头函数包装一层 -->\r\n          <!-- <CountBox @input=\"changeCount\" :value=\"item.goods_num\" class=\"count-box\"></CountBox> -->\r\n          <CountBox @input=\"(value) => changeCount(value,item.goods_id,item.goods_sku_id)\" :value=\"item.goods_num\" class=\"count-box\"></CountBox>\r\n        </div>\r\n    </div>\r\n    <div class=\"foot\">\r\n      <van-checkbox :value=\"isAllChecked\" @click=\"toggleAllCheck()\">全选</van-checkbox>\r\n      <p>合计：￥<span>{{ selPrice }}</span></p>\r\n      <button v-if=\"!isEdit\" class=\"btn\" :class=\"{disabled:selCount === 0}\">结算({{ selCount }})</button>\r\n      <button v-else @click=\"handleDel()\" class=\"btn\" :class=\"{disabled:selCount === 0}\">删除</button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CountBox from '@/components/CountBox.vue'\r\nimport { mapState, mapGetters } from 'vuex'\r\nexport default {\r\n  name: 'ShoppingPage',\r\n  data () {\r\n    return {\r\n      isEdit: false\r\n    }\r\n  },\r\n  created () {\r\n    // 必须是登录过的用户，才能打开购物车列表\r\n    if (this.$store.getters.token) {\r\n      this.$store.dispatch('cart/getCartAction')\r\n    }\r\n  },\r\n  methods: {\r\n    toggleCheck (goodsId) {\r\n      this.$store.commit('cart/toggleCheck', goodsId)\r\n    },\r\n    toggleAllCheck () {\r\n      this.$store.commit('cart/toggleAllCheck', !this.isAllChecked)\r\n    },\r\n    changeCount (goodsNum, goodsId, goodsSkuId) {\r\n      // console.log(goodsNum, goodsId, goodsSkuId)\r\n      // 调用 vuex 的 action，进行数量的修改\r\n      this.$store.dispatch('cart/changeCountAction', {\r\n        goodsNum,\r\n        goodsId,\r\n        goodsSkuId\r\n      })\r\n    },\r\n    handleDel () {\r\n      if (this.selCount === 0) return\r\n      this.$store.dispatch('cart/delSelect')\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapState('cart', ['cartList']),\r\n    ...mapGetters('cart', ['cartTotal', 'selCartList', 'selCount', 'selPrice', 'isAllChecked'])\r\n  },\r\n  components: {\r\n    CountBox\r\n  },\r\n  watch: {\r\n    isEdit (value) {\r\n      if (value) {\r\n        this.$store.commit('cart/toggleAllCheck', false)\r\n      } else {\r\n        this.$store.commit('cart/toggleAllCheck', true)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n@import '@/styles/css/shopping.css';\r\n</style>\r\n"],"mappings":"AA6BA,OAAAA,QAAA;AACA,SAAAC,QAAA,EAAAC,UAAA;AACA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,MAAA;IACA;EACA;EACAC,QAAA;IACA;IACA,SAAAC,MAAA,CAAAC,OAAA,CAAAC,KAAA;MACA,KAAAF,MAAA,CAAAG,QAAA;IACA;EACA;EACAC,OAAA;IACAC,YAAAC,OAAA;MACA,KAAAN,MAAA,CAAAO,MAAA,qBAAAD,OAAA;IACA;IACAE,eAAA;MACA,KAAAR,MAAA,CAAAO,MAAA,8BAAAE,YAAA;IACA;IACAC,YAAAC,QAAA,EAAAL,OAAA,EAAAM,UAAA;MACA;MACA;MACA,KAAAZ,MAAA,CAAAG,QAAA;QACAQ,QAAA;QACAL,OAAA;QACAM;MACA;IACA;IACAC,UAAA;MACA,SAAAC,QAAA;MACA,KAAAd,MAAA,CAAAG,QAAA;IACA;EACA;EACAY,QAAA;IACA,GAAArB,QAAA;IACA,GAAAC,UAAA;EACA;EACAqB,UAAA;IACAvB;EACA;EACAwB,KAAA;IACAnB,OAAAoB,KAAA;MACA,IAAAA,KAAA;QACA,KAAAlB,MAAA,CAAAO,MAAA;MACA;QACA,KAAAP,MAAA,CAAAO,MAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}